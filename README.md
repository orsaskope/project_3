# Εργασία 2 — Neural LSH & Protein Similarity Search

**Μάθημα:** Ανάπτυξη Λογισμικού για Αλγοριθμικά Προβλήματα  
**Ομάδα:** 

- **Βασιλική-Όρσα Σκοπελίτη** (1115201900341)  
- **Γρηγόρης Ταμπαξής** (1115202000188)

---

## 1. Επισκόπηση Project
Η παρούσα εργασία υλοποιεί μια ημιολοκληρωμένη ροή για την αναζήτηση ομοιότητας πρωτεϊνικών ακολουθιών. Το σύστημα μετατρέπει πρωτεΐνες σε διανύσματα υψηλής διάστασης (embeddings) χρησιμοποιώντας το μοντέλο **ESM-2** και συγκρίνει την αποτελεσματικότητα κλασικών αλγορίθμων ANN (LSH, Hypercube, IVF) με τη σύγχρονη μέθοδο **Neural LSH**. Ως μέτρο βιολογικής σύγκρισης χρησιμοποιούνται τα αποτελέσματα του αλγορίθμου **BLAST**.

Δεν καταφεραμε να ολοκληρωσουμε την εργασια.Καταφεραμε ομως να την φτασουμε ακριβως πριν το σημειο συγκρισης blast και ΑΝΝ (δηλαδη εχουμε τα καθαρισμενα δεδομενα αλλα δεν εχουμε υλοποιησει την συγκριση)

---

## 2. Ανάλυση Αρχείων

### `protein_embed.py`
Αυτό το αρχείο υλοποιεί τη φάση παραγωγής των embeddings και τη δημιουργία του ευρετηρίου (index).
* **Παραγωγή Embeddings:** Χρησιμοποιεί το προεκπαιδευμένο μοντέλο `facebook/esm2_t6_8M_UR50D`. Για κάθε ακολουθία, υπολογίζεται ένα διάνυσμα αναπαράστασης μέσω **mean pooling** των αναπαραστάσεων του 6ου επιπέδου (layer) του μοντέλου.
* **Διαχείριση Μνήμης/Ισχύος:** Αν τα αρχεία εξόδου υπάρχουν ήδη, η διαδικασία παραλείπεται για εξοικονόμηση χρόνου.
* **Neural LSH Build:** Εφόσον ολοκληρωθεί η παραγωγή των διανυσμάτων, καλείται αυτόματα η διαδικασία εκπαίδευσης του Neural LSH (`nlsh_build.py`) για τη δημιουργία του ευρετηρίου εφοσον δεν εχει ηδη δημιουργηθει σε παρελθοντικη εκτελεση.

### `protein_search.py`
Το αρχείο αυτό υλοποιεί τη φάση της αναζήτησης και της αρχικής αξιολόγησης.
* **Query Embeddings:** Δημιουργεί embeddings για τις πρωτεΐνες-ερωτήματα (queries) με τον ίδιο τρόπο όπως και για το dataset.
* **Εκτέλεση Αναζήτησης:** Υποστηρίζει την εκτέλεση πολλαπλών μεθόδων (Euclidean LSH, Hypercube, IVF-Flat, IVF-PQ και Neural LSH) μέσω κλήσεων subprocess στα αντίστοιχα εκτελέσιμα αναλογα με την επιλογη method του χρηστη.
* **Αντιστοίχιση (Mapping):** Περιλαμβάνει συναρτήσεις για τη σύνδεση των αριθμητικών δεικτών των αποτελεσμάτων με τα πραγματικά ονόματα των πρωτεϊνών από τα αρχεία FASTA.

---

## 3. Αποτελέσματα

Παρότι δεν προλάβαμε να υλοποιησουμε την συγκριση blast και ΑΝΝ καταγραψαμε τα αποτελεσματα καποιων ΑΝΝ αλγοριθμων με το dataset των πρωτεινων.

### Συγκριτικά Αποτελέσματα Μεθόδων Αναζήτησης

| Μέθοδος | Παράμετροι | Average AF | Recall@N | QPS | tApproximate | tTrue |
| :--- | :--- | :---: | :---: | :---: | :---: | :---: |
| **LSH** | `k:4, L:5, w:4.0` | 1.027241 | 0.708333 | 34.798045 | 0.028737 | 0.114922 |
| **Hypercube** | `kproj:16, w:1.0, M:5000, probes:4` | 1.137919 | 0.466667 | 194.542477 | 0.005140 | 0.129264 |
| **IVF-Flat** | `kclusters:64, nprobe:4` | 1.000000 | 0.958333 | 64.841541 | 0.015422 | 0.202807 |

---

